<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>VIREX LOBBY | REAL-TIME STREAMING</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@700&family=Poppins:wght@300;400;600;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <style>
        :root {
            --blood: #ff0000;
            --dark: #050505;
            --card: #0f0f0f;
            --discord: #5865F2;
            --text: #ffffff;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--dark);
            color: var(--text);
            overflow: hidden; /* Scroll istemiyoruz, uygulama gibi dursun */
        }

        /* NAVBAR */
        .navbar {
            height: 70px; background: #000; border-bottom: 2px solid var(--blood);
            display: flex; align-items: center; justify-content: space-between;
            padding: 0 30px; position: relative; z-index: 100;
        }
        .logo { font-family: 'Oswald'; font-size: 28px; color: var(--blood); cursor: pointer; }

        /* ANA EKRAN DÜZENİ */
        .app-container {
            display: flex;
            height: calc(100vh - 70px);
        }

        /* SOL PANEL: LOBİ LİSTESİ */
        .lobby-sidebar {
            width: 320px; background: var(--card); border-right: 1px solid #222;
            padding: 20px; display: flex; flex-direction: column;
        }

        .lobby-list { flex: 1; overflow-y: auto; margin-top: 20px; }
        .lobby-card {
            background: #1a1a1a; padding: 15px; border-radius: 12px; margin-bottom: 15px;
            border: 1px solid #333; cursor: pointer; transition: 0.3s;
        }
        .lobby-card:hover { border-color: var(--blood); background: #222; }
        .lobby-card h4 { font-size: 15px; color: var(--blood); }
        .lobby-card p { font-size: 12px; color: #888; }

        /* ORTA PANEL: GERÇEK YAYIN ALANI */
        .stream-area {
            flex: 1; background: #000; display: flex; flex-direction: column; position: relative;
        }

        .video-grid {
            flex: 1; display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 10px; padding: 20px; align-content: center;
        }

        .video-wrapper {
            background: #111; border-radius: 15px; overflow: hidden; position: relative;
            border: 2px solid #222; height: 100%; min-height: 300px;
        }
        
        /* GERÇEK VİDEO ELEMENTLERİ */
        video {
            width: 100%; height: 100%; object-fit: cover; background: #000;
            transform: scaleX(-1); /* Ayna efekti */
        }

        .stream-controls {
            height: 100px; background: rgba(0,0,0,0.8); display: flex;
            align-items: center; justify-content: center; gap: 20px;
            border-top: 1px solid #222;
        }

        .action-btn {
            width: 55px; height: 55px; border-radius: 50%; border: none;
            background: #222; color: white; cursor: pointer; font-size: 20px;
            transition: 0.3s;
        }
        .action-btn:hover { background: var(--blood); transform: scale(1.1); }
        .action-btn.off { background: #ff4747; }
        .btn-screen { background: #2ecc71; width: auto; padding: 0 20px; border-radius: 10px; }

        /* SAĞ PANEL: DISCORD STYLE PROFILE */
        .profile-sidebar {
            width: 300px; background: #080808; border-left: 1px solid #222; padding: 20px;
        }

        .dc-profile {
            background: #18191c; border-radius: 12px; overflow: hidden;
        }
        .banner { height: 60px; background: var(--blood); }
        .avatar-area { margin-top: -30px; padding: 0 20px; position: relative; }
        .main-pp { 
            width: 80px; height: 80px; border-radius: 50%; border: 4px solid #18191c;
            background: #000; object-fit: cover;
        }
        .badge-list { display: flex; gap: 5px; margin-top: 10px; }

        /* MAĞAZA MODAL */
        #shopOverlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); z-index: 2000; display: none;
            padding: 100px 10%;
        }

        /* SAĞ TIK */
        .context-menu {
            position: fixed; background: #18191c; border: 1px solid #333;
            width: 200px; border-radius: 8px; display: none; z-index: 3000;
        }
        .menu-item {
            padding: 12px; cursor: pointer; font-size: 14px; display: flex; align-items: center; gap: 10px;
        }
        .menu-item:hover { background: var(--blood); }

    </style>
</head>
<body oncontextmenu="return handleRightClick(event)">

<nav class="navbar">
    <div class="logo" onclick="location.reload()">VIREX<span>CHEATS</span></div>
    <div style="display:flex; gap:30px;">
        <span onclick="toggleView('lobbies')" style="cursor:pointer; font-weight:800; border-bottom: 2px solid var(--blood)">ANASAYFA / LOBİLER</span>
        <span onclick="toggleShop(true)" style="cursor:pointer; color:#888;">MAĞAZA</span>
    </div>
    <div class="user-info" style="display:flex; align-items:center; gap:10px;">
        <span id="userNameDisplay">Syvex#0001</span>
        <img src="https://media.tenor.com/y_S_m7T36m8AAAAM/anime-aesthetic.gif" style="width:35px; height:35px; border-radius:50%;">
    </div>
</nav>

<div class="app-container">
    <aside class="lobby-sidebar">
        <button class="action-btn btn-screen" style="width:100%; margin-bottom:20px;" onclick="createNewLobby()">
            <i class="fas fa-plus"></i> LOBİ OLUŞTUR
        </button>
        <div class="lobby-list" id="globalLobbies">
            <div class="lobby-card" onclick="joinLobby('CS2 Hile Paylaşımı')">
                <h4>CS2 Hile Paylaşımı</h4>
                <p>Oluşturan: AhmetPro - 4 Oyuncu</p>
            </div>
            <div class="lobby-card" onclick="joinLobby('Roblox Script Lobi')">
                <h4>Roblox Script Lobi</h4>
                <p>Oluşturan: Kerem_Exe - 7 Oyuncu</p>
            </div>
        </div>
    </aside>

    <main class="stream-area">
        <div class="video-grid" id="videoGrid">
            <div class="video-wrapper">
                <video id="localVideo" autoplay playsinline muted></video>
                <div style="position:absolute; bottom:10px; left:10px; background:rgba(0,0,0,0.6); padding:4px 10px; border-radius:5px; font-size:12px;">
                    <i class="fas fa-microphone"></i> Siz (Canlı)
                </div>
            </div>
            <div class="video-wrapper" id="screenWrapper" style="display:none;">
                <video id="screenVideo" autoplay playsinline></video>
                <div style="position:absolute; top:10px; right:10px; background:var(--blood); padding:4px 10px; border-radius:5px; font-size:10px; font-weight:800;">EKRAN PAYLAŞILIYOR</div>
            </div>
        </div>

        <div class="stream-controls">
            <button class="action-btn" id="micBtn" onclick="toggleMic()">
                <i class="fas fa-microphone"></i>
            </button>
            <button class="action-btn" id="camBtn" onclick="toggleCam()">
                <i class="fas fa-video"></i>
            </button>
            <button class="action-btn btn-screen" onclick="startScreenShare()">
                <i class="fas fa-desktop"></i> EKRAN PAYLAŞ
            </button>
            <button class="action-btn off" onclick="location.reload()">
                <i class="fas fa-phone-slash"></i>
            </button>
        </div>
    </main>

    <aside class="profile-sidebar">
        <div class="dc-profile">
            <div class="banner"></div>
            <div class="avatar-area">
                <img src="https://media.tenor.com/y_S_m7T36m8AAAAM/anime-aesthetic.gif" class="main-pp" id="userPP">
                <img src="https://cdn.discordapp.com/avatar-decoration-presets/v2/a_550220979667c31d17d096c466488344.png" 
                     style="position:absolute; top:-10px; left:10px; width:100px;">
                <div style="margin-top:10px; font-weight:800; font-size:20px;">Syvex <span style="color:#888; font-weight:400;">#0001</span></div>
                <div class="badge-list">
                    <img src="https://raw.githubusercontent.com/mezotv/discord-badges/main/assets/discordnitro.svg" width="20">
                    <img src="https://raw.githubusercontent.com/mezotv/discord-badges/main/assets/discordstaff.svg" width="20">
                </div>
                <hr style="border:0; border-top:1px solid #333; margin:15px 0;">
                <div style="font-size:11px; font-weight:800; color:#888;">HAKKINDA</div>
                <p style="font-size:13px; margin-top:5px;">Virex Admin & Developer. Hareketli profil aktif.</p>
                <button class="action-btn btn-screen" style="width:100%; margin-top:15px; font-size:12px; height:40px;" onclick="editProfile()">PROFİLİ DÜZENLE</button>
            </div>
        </div>
    </aside>
</div>

<div id="shopOverlay">
    <h1 style="font-family:'Oswald'; color:var(--blood); font-size:50px; margin-bottom:30px;">HİLE MAĞAZASI</h1>
    <div style="display:grid; grid-template-columns:repeat(4, 1fr); gap:20px;">
        <div class="lobby-card" style="text-align:center;">
            <img src="https://www.freeiconspng.com/uploads/csgo-icon-12.png" width="80">
            <h3>CS2 HACK</h3>
            <p>BEDAVA</p>
            <button class="action-btn btn-screen" onclick="window.location.href='https://data.exloader.net/ExLoader_Installer.exe'">İNDİR</button>
        </div>
        </div>
    <button class="action-btn" style="position:absolute; top:40px; right:40px;" onclick="toggleShop(false)">X</button>
</div>

<div id="contextMenu" class="context-menu">
    <div class="menu-item" onclick="alert('Ses kapatıldı')"><i class="fas fa-volume-mute"></i> Sesi Kapat</div>
    <div class="menu-item" onclick="alert('Ekran Gizlendi')"><i class="fas fa-eye-slash"></i> Ekranı Gizle</div>
    <div class="menu-item" style="color:var(--blood)" onclick="location.reload()"><i class="fas fa-sign-out-alt"></i> Lobiden At</div>
</div>

<script>
    let localStream;
    let screenStream;
    let isCamOn = true;
    let isMicOn = true;

    // 1. GERÇEK KAMERA VE SESİ BAŞLAT
    async function initCamera() {
        try {
            localStream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });
            document.getElementById('localVideo').srcObject = localStream;
        } catch (err) {
            console.error("Hata:", err);
            Swal.fire("Hata", "Kamera izni verilmedi!", "error");
        }
    }

    // 2. GERÇEK EKRAN PAYLAŞIMI
    async function startScreenShare() {
        try {
            screenStream = await navigator.mediaDevices.getDisplayMedia({ video: true });
            const screenVideo = document.getElementById('screenVideo');
            const wrapper = document.getElementById('screenWrapper');
            
            screenVideo.srcObject = screenStream;
            wrapper.style.display = 'block';

            // Paylaşım durduğunda kapat
            screenStream.getVideoTracks()[0].onended = () => {
                wrapper.style.display = 'none';
            };
        } catch (err) {
            console.error("Ekran paylaşımı hatası:", err);
        }
    }

    // MİKROFON AÇ-KAPA
    function toggleMic() {
        isMicOn = !isMicOn;
        localStream.getAudioTracks()[0].enabled = isMicOn;
        document.getElementById('micBtn').classList.toggle('off', !isMicOn);
        document.getElementById('micBtn').innerHTML = isMicOn ? '<i class="fas fa-microphone"></i>' : '<i class="fas fa-microphone-slash"></i>';
    }

    // KAMERA AÇ-KAPA
    function toggleCam() {
        isCamOn = !isCamOn;
        localStream.getVideoTracks()[0].enabled = isCamOn;
        document.getElementById('camBtn').classList.toggle('off', !isCamOn);
        document.getElementById('camBtn').innerHTML = isCamOn ? '<i class="fas fa-video"></i>' : '<i class="fas fa-video-slash"></i>';
    }

    // LOBİ OLUŞTURMA (DİNAMİK)
    function createNewLobby() {
        Swal.fire({
            title: 'Lobi Adı',
            input: 'text',
            background: '#111',
            color: '#fff',
            confirmButtonColor: '#ff0000'
        }).then((res) => {
            if(res.value) {
                const list = document.getElementById('globalLobbies');
                const newCard = document.createElement('div');
                newCard.className = 'lobby-card';
                newCard.innerHTML = `<h4>${res.value}</h4><p>Oluşturan: Siz - 1 Oyuncu</p>`;
                newCard.onclick = () => joinLobby(res.value);
                list.prepend(newCard);
                joinLobby(res.value);
            }
        });
    }

    function joinLobby(name) {
        Swal.fire({ title: name + ' Lobisine Girildi', timer: 1500, showConfirmButton: false, background: '#111', color: '#fff' });
    }

    // PROFİL DÜZENLEME
    function editProfile() {
        Swal.fire({
            title: 'Profil Düzenle',
            html: `
                <input id="swal-input1" class="swal2-input" placeholder="Yeni Ad" style="background:#222; color:#fff; border:1px solid #444">
                <input id="swal-input2" class="swal2-input" placeholder="Yeni PP (URL)" style="background:#222; color:#fff; border:1px solid #444">
            `,
            background: '#111',
            color: '#fff'
        }).then((res) => {
            if(res.isConfirmed) {
                const name = document.getElementById('swal-input1').value;
                const pp = document.getElementById('swal-input2').value;
                if(name) document.getElementById('userNameDisplay').innerText = name;
                if(pp) {
                    document.getElementById('userPP').src = pp;
                    // Hareketli GIF ise otomatik oynar zaten
                }
            }
        });
    }

    // MAĞAZA KONTROL
    function toggleShop(show) {
        document.getElementById('shopOverlay').style.display = show ? 'block' : 'none';
    }

    // SAĞ TIK
    function handleRightClick(e) {
        e.preventDefault();
        const menu = document.getElementById('contextMenu');
        menu.style.display = 'block';
        menu.style.left = e.pageX + 'px';
        menu.style.top = e.pageY + 'px';
        return false;
    }

    window.onclick = () => document.getElementById('contextMenu').style.display = 'none';

    // BAŞLAT
    initCamera();

</script>

</body>
</html>
